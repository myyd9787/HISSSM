<!DOCTYPE HTML>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="renderer" content="webkit|ie-comp|ie-stand">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
		<meta http-equiv="Cache-Control" content="no-siteapp" />
		<!--[if lt IE 9]>
		<script type="text/javascript" src="../../../lib/html5shiv.js"></script>
		<script type="text/javascript" src="../../../lib/respond.min.js"></script>
		<![endif]-->
		<link rel="stylesheet" type="text/css" href="../../../static/h-ui/css/H-ui.min.css" />
		<link rel="stylesheet" type="text/css" href="../../../static/h-ui.admin/css/H-ui.admin.css" />
		<link rel="stylesheet" type="text/css" href="../../../lib/Hui-iconfont/1.0.9/iconfont.css" />
		<link rel="stylesheet" type="text/css" href="../../../static/h-ui.admin/skin/default/skin.css" id="skin" />
		<link rel="stylesheet" type="text/css" href="../../../static/h-ui.admin/css/style.css" />
		<link rel="stylesheet" href="../../../lib/zTree/v3/css/zTreeStyle/zTreeStyle.css" type="text/css">
		<link rel="stylesheet" href="../../../lib/layui/css/layui.css" media="all">

		<!--[if IE 6]>
		<script type="text/javascript" src="../../../lib/DD_belatedPNG_0.0.8a-min.js"></script>
		<script>DD_belatedPNG.fix('*');</script>
		<![endif]-->
		<title>患者检验</title>
	</head>
	<body>
		<nav class="breadcrumb"><i class="Hui-iconfont">&#xe67f;</i> 首页 <span class="c-gray en">&gt;</span> 医技处置 <span class="c-gray en">&gt;</span>
			患者检验 <a class="btn btn-success radius r" style="line-height:1.6em;margin-top:3px" href="javascript:location.replace(location.href);"
			 title="刷新"><i class="Hui-iconfont">&#xe68f;</i></a></nav>
		<div style="padding: 5px; border: 1px solid lightgray;">
			<div class="layui-row layui-col-space15">
				<div class="layui-col-md3">
					<div class="layui-row layui-col-space15">
						<div class="layui-col-md9">
							患者名：
							<div class="layui-inline">
								<input class="layui-input" name="category" id="demoReload" autocomplete="off" placeholder="请输入内容">
							</div>
						</div>
						<div class="layui-col-md3">
							<button class="layui-btn" style="float: right;" data-type="reload">搜索</button>
						</div>
					</div>
					<div class="layui-row layui-col-space15">
						<div class="layui-col-md9">医技检验
						</div>
						<div class="layui-col-md3">
							<a style="float:right" class="layui-btn" id="btn-refresh"><i class="layui-icon">&#xe9aa;</i></a>
						</div>

					</div>

					<table class="layui-hide" id="test" lay-filter="testReload"></table>
				</div>
				<div class="layui-col-md9">
					<div class="layui-card">
						<div class="layui-card-header">详细</div>
						<div class="layui-card-body">
							<form class="layui-form">
								<div class="layui-form-item">
									<label class="layui-form-label">病历号</label>
									<div class="layui-input-inline">
										<input type="text" name="caseNumber" lay-verify="required|number" autocomplete="off" class="layui-input">
									</div>

									<label class="layui-form-label">患者姓名</label>
									<div class="layui-input-inline">
										<input type="tel" name="realName" lay-verify="url" autocomplete="off" class="layui-input">
									</div>
									<label class="layui-form-label">年龄</label>
									<div class="layui-input-inline">
										<input type="tel" name="age" lay-verify="url" autocomplete="off" class="layui-input">
									</div>
								</div>
								<div class="layui-form-item">
									<label class="layui-form-label">结算类别</label>
									<div class="layui-input-inline">
										<input type="text" name="settleId" lay-verify="required|number" autocomplete="off" class="layui-input">
									</div>

									<label class="layui-form-label">就诊科室</label>
									<div class="layui-input-inline">
										<input type="tel" name="deptId" lay-verify="url" autocomplete="off" class="layui-input">
									</div>
									<label class="layui-form-label">处方状态</label>
									<div class="layui-input-inline">
										<input type="tel" name="visitState" lay-verify="url" autocomplete="off" class="layui-input">
									</div>
								</div>
								<div class="layui-form-item">
									<label class="layui-form-label">挂号员</label>
									<div class="layui-input-inline">
										<input type="text" name="registerId" lay-verify="url"  autocomplete="off" class="layui-input">
									</div>

									<label class="layui-form-label">开立医生</label>
									<div class="layui-input-inline">
										<input type="tel" name="userId" lay-verify="url" autocomplete="off" class="layui-input">
									</div>
									<label class="layui-form-label">级别</label>
									<div class="layui-input-inline">
										<input type="tel" name="registLeID" lay-verify="url" autocomplete="off" class="layui-input">
									</div>
								</div>
							</form>
							<table class="layui-hide" id="test2" lay-filter="testReload2"></table>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!--_footer 作为公共模版分离出去-->
		<script type="text/javascript" src="../../lib/jquery/1.9.1/jquery.min.js"></script>
		<script type="text/javascript" src="../../lib/layer/2.4/layer.js"></script>
		<script type="text/javascript" src="../../static/h-ui/js/H-ui.min.js"></script>
		<script type="text/javascript" src="../../static/h-ui.admin/js/H-ui.admin.js"></script>
		<!--/_footer 作为公共模版分离出去-->

		<!--请在下方写此页面业务相关的脚本-->
		<script type="text/javascript" src="../../lib/zTree/v3/js/jquery.ztree.all-3.5.min.js"></script>
		<script type="text/javascript" src="../../lib/layui/layui.js">

		</script>
		<script type="text/javascript">
			layui.use('table', function() {
				var table = layui.table,
					$ = layui.jquery;

				var tableIns = table.render({
					elem: '#test',
					cellMinWidth: 80,
					skin: 'line',
					cols: [
						[ {
							field: 'caseNumber',
							title: '病历号'
						}, {
							field: 'realName',
							title: '患者姓名'
						},  {
							field: 'invoiceNum',
							title: '发票号码',
                            hide:true
						}, {
							field: 'age',
							title: '年龄',
						},
						{
							field: 'settleID',
							title: '结算类别',
							hide:true
						},
						{
							field: 'deptId',
							title: '就诊科室',
							hide:true
						},
						{
							field: 'prescriptionState',
							title: '处方状态',
							hide:true
						},
						{
							field: 'userID',
							title: '开立医生',
							hide:true
						},
						{
							field: 'visitState',
							title: '本次看诊状态',
							hide:true
						},
						{
							field: 'registLeID',
							title: '挂号级别',
							hide:true
						},
                        {
							field: 'registerId',
							title: '挂号员',
							hide:true
						},
						{
							field: 'noon',
							title: '上下午',
							hide:true
						},
                         {
							 field: 'price',
							 title: '单价',
							 hide:true
						 },
						 {
							 field: 'sum',
							 title: '总金额',
							 hide:true
						 },
                         {
							 field: 'state',
							 title: '状态',
							 hide:true
                            }]
					],
					url: '../../PatientServlet?method=state1',
					id: 'testReload',
					event: true
				});

				$('.demoTable .layui-btn').on('click', function() {
					var categoryval = $('#demoReload').val();
					table.reload('testReload', {
						where: {
							category: categoryval
						}
					});
				});
				// 刷新
				$('#btn-refresh').on('click', function() {
					tableIns.reload();
				});
				//监听行单击事件（单击事件为：rowDouble）
				table.on('row(testReload)', function(obj) {
					var data = obj.data;

					// layer.alert(JSON.stringify(data), {
					// 	title: '当前行数据：'
					// });
					$("input[name = caseNumber]").val(data.caseNumber);
                    $("input[name = realName]").val(data.realName);
                    $("input[name = age]").val(data.age);
                    $("input[name = settleId]").val(data.settleId);
                    $("input[name = deptId]").val(data.deptId);
                    $("input[name = age]").val(data.age);
                    $("input[name = visitState]").val(data.visitState);
                    $("input[name = registerId]").val(data.registerId);
                    $("input[name = userId]").val(data.userId);
                    $("input[name = registLeID]").val(data.registLeId);

					loadcheck(data.caseNumber);

					//标注选中样式
					obj.tr.addClass('layui-table-click').siblings().removeClass('layui-table-click');

				});
				function loadcheck(caseNumber) {
                    var table2 = table.render({
                        elem: '#test2'
                        ,url: '../../PatientServlet?method=plist2&caseNumber='+caseNumber //数据接口
                        ,cols: [[ //表头
                            {field: 'name', title: '检验名称', fixed: 'left'}
                            ,{field: 'position', title: '检验部位'}
                            ,{field: 'num', title: '数量'}
                            ,{field: 'danwei', title: '单位'}
                            ,{field: 'price', title:'单价'}
                            ,{field: 'sum', title: '总金额'}
                            ,{field: 'state', title: '状态'}
                        ]],
                        id: 'testReload2',
                        event: true,
                        page:true,
                        limit:5
                    });
                }
			});
		</script>
	</body>
</html>
